{% extends "base.html" %}
{% block content %}
<h2>Welcome, {{ username }} ðŸ‘‹</h2>

<h3>Add New Task / Habit</h3>
<form method="POST">
    <input type="text" name="task" placeholder="Task name" required><br>
    Category: 
    <select name="category">
        <option>General</option>
        <option>Work</option>
        <option>Study</option>
        <option>Health</option>
    </select><br>
    Notes: <input type="text" name="notes" placeholder="Optional notes"><br>
    <button type="submit">Add Task</button>
</form>

<h3>Your Tasks</h3>
<ul>
    {% for task in tasks %}
        <li>
            {{ task[1] }} | {{ task[2] }} | {{ task[3] }} | {{ task[4] }}
            {% if task[4] == "pending" %}
                <a href="{{ url_for('complete_task', task_id=task[0]) }}">[Mark Completed]</a>
            {% endif %}
        </li>
    {% endfor %}
</ul>

<h3>Analytics</h3>
<p>Category Completion Rate:</p>
<ul>
    {% for cat, rate in category_stats.items() %}
        <li>{{ cat }}: {{ "%.1f"|format(rate) }}%</li>
    {% endfor %}
</ul>

<p>Current Streak: {{ streak }} days</p>

<a href="{{ url_for('logout') }}">Logout</a>
{% endblock %}
